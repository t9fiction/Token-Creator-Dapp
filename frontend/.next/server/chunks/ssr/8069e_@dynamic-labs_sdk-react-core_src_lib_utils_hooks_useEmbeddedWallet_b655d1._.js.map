{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///home/sohail/mystuff/10-Work/projects/erc20saas/frontend/node_modules/%40dynamic-labs/sdk-react-core/src/lib/utils/hooks/useEmbeddedWallet/useSecureEnclaveEmbeddedWallet/constants.js"],"sourcesContent":["'use client'\nconst iframeContainerId = 'dyn-secure-enclave-container-id';\nconst iframeElementId = 'dyn-secure-enclave-element-id';\nconst revealIframeContainerId = 'dyn-secure-enclave-export-container-id';\nconst revealIframeElementId = 'dyn-secure-enclave-export-element-id';\nvar EmbeddedWalletVersion;\n(function (EmbeddedWalletVersion) {\n    EmbeddedWalletVersion[\"V1\"] = \"V1\";\n    EmbeddedWalletVersion[\"V2\"] = \"V2\";\n})(EmbeddedWalletVersion || (EmbeddedWalletVersion = {}));\n\nexport { EmbeddedWalletVersion, iframeContainerId, iframeElementId, revealIframeContainerId, revealIframeElementId };\n"],"names":[],"mappings":";;;;;;;AAAA;AACA,MAAM,oBAAoB;AAC1B,MAAM,kBAAkB;AACxB,MAAM,0BAA0B;AAChC,MAAM,wBAAwB;AAC9B,IAAI;AACJ,CAAC,SAAU,qBAAqB;IAC5B,qBAAqB,CAAC,KAAK,GAAG;IAC9B,qBAAqB,CAAC,KAAK,GAAG;AAClC,CAAC,EAAE,yBAAyB,CAAC,wBAAwB,CAAC,CAAC","ignoreList":[0]}},
    {"offset": {"line": 25, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 31, "column": 0}, "map": {"version":3,"sources":["file:///home/sohail/mystuff/10-Work/projects/erc20saas/frontend/node_modules/%40dynamic-labs/sdk-react-core/src/lib/utils/hooks/useEmbeddedWallet/useSecureEnclaveEmbeddedWallet/useTurnkey/useTurnkey.js"],"sourcesContent":["'use client'\nimport { __awaiter } from '../../../../../../../_virtual/_tslib.js';\nimport { useCallback } from 'react';\nimport { EmbeddedWalletVersionEnum, JwtVerifiedCredentialFormatEnum } from '@dynamic-labs/sdk-api-core';\nimport '../../../../../context/DynamicContext/DynamicContext.js';\nimport { logger } from '../../../../../shared/logger.js';\nimport '@dynamic-labs/iconic';\nimport '@dynamic-labs/wallet-connector-core';\nimport 'react/jsx-runtime';\nimport { useViewContext } from '../../../../../context/ViewContext/ViewContext.js';\nimport '@dynamic-labs/wallet-book';\nimport '@dynamic-labs/utils';\nimport '../../../../constants/colors.js';\nimport '../../../../constants/values.js';\nimport '../../../../../store/state/loadingAndLifecycle.js';\nimport '../../../../../shared/consts/index.js';\nimport { dynamicEvents } from '../../../../../events/dynamicEvents.js';\nimport '../../../../../context/CaptchaContext/CaptchaContext.js';\nimport '../../../../../context/ErrorContext/ErrorContext.js';\nimport { findEmbeddedWalletFromVerifiedCredentials } from '../../../../functions/findEmbeddedWalletFromVerifiedCredentials/findEmbeddedWalletFromVerifiedCredentials.js';\nimport { findTurnkeyWalletByChain } from '../../../../functions/findTurnkeyWallet/findTurnkeyWallet.js';\nimport '@dynamic-labs/multi-wallet';\nimport 'react-international-phone';\nimport { getUserWalletsFromVerifiedCredentials } from '../../../../functions/getUserWalletsFromVerifiedCredentials/getUserWalletsFromVerifiedCredentials.js';\nimport '../../../../../config/ApiEndpoint.js';\nimport '../../../../../store/state/user/user.js';\nimport '../../../../../locale/locale.js';\nimport { getUserVerifiedCredentialType } from '../../../../functions/getUserVerifiedCredentialType/getUserVerifiedCredentialType.js';\nimport '../../../../../store/state/projectSettings/projectSettings.js';\nimport '../../../../../context/AccessDeniedContext/AccessDeniedContext.js';\nimport '../../../../../context/AccountExistsContext/AccountExistsContext.js';\nimport '../../../../../context/UserWalletsContext/UserWalletsContext.js';\nimport { USER_NOT_LOGGED_IN } from '../../../../constants/errors.js';\nimport '../../../../../context/VerificationContext/VerificationContext.js';\nimport 'react-dom';\nimport { useCreateDynamicEmbeddedWalletMutation } from '../../../useCreateDynamicEmbeddedWalletMutation/useCreateDynamicEmbeddedWalletMutation.js';\nimport '../../../../../context/WalletContext/WalletContext.js';\nimport { useSmartWallets } from '../../../useSmartWallets/useSmartWallets.js';\nimport { findPrimaryEmbeddedChain } from '../../../../../views/Passkey/utils/findPrimaryEmbeddedChain/findPrimaryEmbeddedChain.js';\nimport '../constants.js';\nimport { findPasskeyEmailWalletConnector } from '../../../../../views/Passkey/utils/findPasskeyEmailWalletConnector/findPasskeyEmailWalletConnector.js';\nimport { findSmartWallet, initializeSmartWallet } from '../../../useWalletConnectors/utils/smartWallet/smartWallet.js';\nimport '../../../../../context/ThemeContext/ThemeContext.js';\nimport '../../../useUserUpdateRequest/useUpdateUser/userFieldsSchema.js';\nimport '@dynamic-labs/types';\nimport '../../../../../context/LoadingContext/LoadingContext.js';\nimport 'yup';\nimport '../../../../../context/MockContext/MockContext.js';\nimport '../../../../../views/CollectUserDataView/useFields.js';\nimport '../../../../../context/FieldsStateContext/FieldsStateContext.js';\nimport '../../../../../context/UserFieldEditorContext/UserFieldEditorContext.js';\nimport '@dynamic-labs/rpc-providers';\nimport '../../../../../store/state/environmentId.js';\nimport '../../../../../store/state/walletConnectorOptions.js';\nimport 'react-i18next';\nimport '../../../../../components/Accordion/components/AccordionItem/AccordionItem.js';\nimport '../../../../../components/Alert/Alert.js';\nimport '../../../../../components/ShadowDOM/ShadowDOM.js';\nimport '../../../../../components/IconButton/IconButton.js';\nimport '../../../../../components/InlineWidget/InlineWidget.js';\nimport '../../../../../components/Input/Input.js';\nimport '../../../../../components/IsBrowser/IsBrowser.js';\nimport '../../../../../components/MenuList/Dropdown/Dropdown.js';\nimport '../../../../../components/Transition/ZoomTransition/ZoomTransition.js';\nimport '../../../../../components/Transition/SlideInUpTransition/SlideInUpTransition.js';\nimport '../../../../../components/Transition/OpacityTransition/OpacityTransition.js';\nimport '../../../../../components/OverlayCard/OverlayCardTarget/OverlayCardTarget.js';\nimport '../../../../../components/PasskeyCreatedSuccessBanner/PasskeyCreatedSuccessBanner.js';\nimport '../../../../../components/Popper/Popper/Popper.js';\nimport '../../../../../components/Popper/PopperContext/PopperContext.js';\nimport 'react-focus-lock';\nimport 'qrcode';\nimport 'formik';\nimport '../../../../../context/FooterAnimationContext/index.js';\nimport '../../../../../context/WalletGroupContext/WalletGroupContext.js';\nimport '../../../../../context/IpConfigurationContext/IpConfigurationContext.js';\nimport '../../../../../context/SocialRedirectContext/SocialRedirectContext.js';\nimport '../../../../../widgets/DynamicBridgeWidget/views/WalletsView/components/SecondaryWallets/SecondaryWallets.js';\nimport '@hcaptcha/react-hcaptcha';\nimport '../../../../../widgets/DynamicWidget/context/DynamicWidgetContext.js';\nimport '../../../../../context/PasskeyContext/PasskeyContext.js';\nimport '../../../../../store/state/sendBalances.js';\nimport '../../../../../widgets/DynamicWidget/components/DynamicWidgetHeader/DynamicWidgetHeader.js';\nimport '../../../../../views/TransactionConfirmationView/TransactionConfirmationView.js';\nimport '../../../../../widgets/DynamicWidget/views/ManagePasskeysWidgetView/PasskeyCard/PasskeyCard.js';\nimport '../../../../../../index.js';\nimport '../../../../../store/state/tokenBalances.js';\nimport '../../../../../shared/utils/functions/getInitialUrl/getInitialUrl.js';\nimport { useInternalDynamicContext } from '../../../../../context/DynamicContext/useDynamicContext/useInternalDynamicContext.js';\n\n// Hook exposed to customers and used internally to trigger embedded wallet creation\nconst useTurnkey = () => {\n    const { projectSettings, setPrimaryWalletId, walletConnectorOptions, setShowAuthFlow, environmentId, user, primaryWallet, } = useInternalDynamicContext();\n    const { setView } = useViewContext();\n    const { createDynamicEmbeddedWalletMutation } = useCreateDynamicEmbeddedWalletMutation();\n    const { getEOAWallet } = useSmartWallets();\n    const startHeadlessEmbeddedWalletCreationFlow = useCallback((chains, options) => __awaiter(void 0, void 0, void 0, function* () {\n        return new Promise((resolve, reject) => {\n            // register the event listeners before calling create embedded wallet\n            // as the event might fire before the listeners are registered.\n            dynamicEvents.once('embeddedWalletCreated', (wallet) => {\n                resolve(wallet);\n            });\n            dynamicEvents.once('embeddedWalletFailed', (error) => reject(error));\n            createDynamicEmbeddedWalletMutation({\n                chains,\n                environmentId,\n                options,\n                walletConnectorOptions,\n                withAuthenticator: false,\n            })\n                .then(() => {\n                setShowAuthFlow(false, { performMultiWalletChecks: false }); // close email otp pin modal\n            })\n                .catch((error) => {\n                reject(error);\n            });\n        });\n    }), [\n        createDynamicEmbeddedWalletMutation,\n        environmentId,\n        walletConnectorOptions,\n        setShowAuthFlow,\n    ]);\n    const startPasskeyEmbeddedWalletCreationFlow = useCallback((chains) => __awaiter(void 0, void 0, void 0, function* () {\n        setShowAuthFlow(true, {\n            ignoreIfIsEmbeddedWidget: false,\n            performMultiWalletChecks: false,\n        });\n        setView('passkey-intro', { chains });\n        return new Promise((resolve, reject) => {\n            dynamicEvents.once('embeddedWalletCreated', (wallet) => resolve(wallet));\n            dynamicEvents.once('embeddedWalletFailed', (error) => {\n                // when creating a passkey, if user cancels the passkey modal more than once\n                // it will throw this DOMException, but we don't want to let user to have access\n                // to the app before they've a passkey correctly setup\n                if (error instanceof DOMException &&\n                    error.name === 'NotAllowedError') {\n                    logger.error('User cancelled the passkey creation.', error);\n                    return;\n                }\n                reject(error);\n            });\n        });\n    }), [setShowAuthFlow, setView]);\n    const returnEmbeddedWallet = useCallback((embeddedWalletVerifiedCredential) => __awaiter(void 0, void 0, void 0, function* () {\n        var _a, _b;\n        const { chain } = embeddedWalletVerifiedCredential;\n        const turnkeyWallet = findTurnkeyWalletByChain(walletConnectorOptions, chain);\n        let newPrimaryWalletId = null;\n        // if user already has embedded wallet, set it as primary wallet\n        if (user) {\n            (_a = turnkeyWallet === null || turnkeyWallet === void 0 ? void 0 : turnkeyWallet.walletConnector) === null || _a === void 0 ? void 0 : _a.setVerifiedCredentials(user.verifiedCredentials);\n            const smartWallet = findSmartWallet(embeddedWalletVerifiedCredential, user.verifiedCredentials);\n            if (smartWallet) {\n                yield initializeSmartWallet({\n                    account: smartWallet,\n                    primaryWalletId: smartWallet.id,\n                    verifiedCredentials: user.verifiedCredentials,\n                    walletConnectorOptions,\n                });\n                newPrimaryWalletId = smartWallet.id;\n            }\n            else {\n                newPrimaryWalletId = embeddedWalletVerifiedCredential.id;\n            }\n        }\n        if (newPrimaryWalletId)\n            setPrimaryWalletId(newPrimaryWalletId);\n        /** It's not authenticated if it still hasn't created a passkey */\n        const isAuthenticated = Boolean((_b = embeddedWalletVerifiedCredential.walletProperties) === null || _b === void 0 ? void 0 : _b.isAuthenticatorAttached);\n        if (!(turnkeyWallet === null || turnkeyWallet === void 0 ? void 0 : turnkeyWallet.walletConnector)) {\n            throw new Error('Could not find the embedded wallet connector');\n        }\n        const connector = turnkeyWallet.walletConnector;\n        const passkeyWallet = connector.createWallet({\n            address: (yield connector.getAddress()) || '',\n            chain: connector.connectedChain,\n            connector,\n            id: embeddedWalletVerifiedCredential.id,\n            isAuthenticated,\n            key: embeddedWalletVerifiedCredential.walletName || connector.key || '',\n        });\n        return Promise.resolve(passkeyWallet);\n    }), [setPrimaryWalletId, walletConnectorOptions, user]);\n    const createTurnkeyWallet = useCallback((chains, options) => __awaiter(void 0, void 0, void 0, function* () {\n        var _c, _d, _e, _f, _g, _h;\n        if (!user) {\n            throw new Error(USER_NOT_LOGGED_IN);\n        }\n        const isManualMode = ((_c = projectSettings === null || projectSettings === void 0 ? void 0 : projectSettings.sdk.embeddedWallets) === null || _c === void 0 ? void 0 : _c.automaticEmbeddedWalletCreation) === false;\n        const shouldCreateV2WalletsByDefault = ((_d = projectSettings === null || projectSettings === void 0 ? void 0 : projectSettings.sdk.embeddedWallets) === null || _d === void 0 ? void 0 : _d.defaultWalletVersion) ===\n            EmbeddedWalletVersionEnum.V2;\n        const primaryChain = findPrimaryEmbeddedChain(projectSettings);\n        // if embedded wallet already exists\n        // get the one with the primary chain if `chains` is undefined\n        const embeddedWalletVerifiedCredential = findEmbeddedWalletFromVerifiedCredentials(user, chains !== null && chains !== void 0 ? chains : [primaryChain]);\n        const userWalletsCredentials = getUserWalletsFromVerifiedCredentials(user);\n        // If the user doesn't have a wallet, or if the customer is in Manual\n        // Mode, we should attempt to create a new wallet. Note that if in manual\n        // mode, the check for the existance of an embedded wallet was arbitrarily\n        // added as a safeguard given the pre-existing condition we're overriding.\n        if (!(userWalletsCredentials === null || userWalletsCredentials === void 0 ? void 0 : userWalletsCredentials.length) ||\n            (!embeddedWalletVerifiedCredential && isManualMode)) {\n            const hasEmailVC = getUserVerifiedCredentialType(user, JwtVerifiedCredentialFormatEnum.Email);\n            if ((!((_e = projectSettings === null || projectSettings === void 0 ? void 0 : projectSettings.sdk.embeddedWallets) === null || _e === void 0 ? void 0 : _e.forceAuthenticatorAtSignup) &&\n                hasEmailVC) ||\n                (options === null || options === void 0 ? void 0 : options.webAuthnAttestation) ||\n                shouldCreateV2WalletsByDefault) {\n                // create embedded wallet fully headless\n                return startHeadlessEmbeddedWalletCreationFlow(chains, options);\n            }\n            else {\n                // show the passkey view to create an embedded wallet\n                return startPasskeyEmbeddedWalletCreationFlow(chains);\n            }\n        }\n        else {\n            // the pregenerated wallet must have been created at this point in the\n            // backend if this called as part of a new user sign up.\n            if (embeddedWalletVerifiedCredential &&\n                user.newUser &&\n                ((_f = projectSettings === null || projectSettings === void 0 ? void 0 : projectSettings.sdk.embeddedWallets) === null || _f === void 0 ? void 0 : _f.automaticEmbeddedWalletCreation)) {\n                const walletConnector = findPasskeyEmailWalletConnector(walletConnectorOptions, primaryChain);\n                if (!walletConnector) {\n                    throw new Error('Could not find the embedded wallet connector');\n                }\n                const wallet = walletConnector.createWallet({\n                    address: (yield walletConnector.getAddress()) || '',\n                    chain: walletConnector.connectedChain,\n                    connector: walletConnector,\n                    id: embeddedWalletVerifiedCredential.id,\n                    isAuthenticated: Boolean((_g = embeddedWalletVerifiedCredential === null || embeddedWalletVerifiedCredential === void 0 ? void 0 : embeddedWalletVerifiedCredential.walletProperties) === null || _g === void 0 ? void 0 : _g.isAuthenticatorAttached),\n                    key: (_h = embeddedWalletVerifiedCredential.walletName) !== null && _h !== void 0 ? _h : walletConnector.key,\n                });\n                setPrimaryWalletId(embeddedWalletVerifiedCredential.id);\n                dynamicEvents.emit('embeddedWalletCreated', wallet, embeddedWalletVerifiedCredential, user);\n            }\n        }\n        setShowAuthFlow(false, { performMultiWalletChecks: false });\n        // if user logged in with MM for example, just continue the flow\n        if (!embeddedWalletVerifiedCredential) {\n            throw new Error('Primary wallet is not an embedded wallet');\n        }\n        // if user already has embedded wallet, returns it\n        return returnEmbeddedWallet(embeddedWalletVerifiedCredential);\n    }), [\n        user,\n        projectSettings,\n        primaryWallet,\n        getEOAWallet,\n        setShowAuthFlow,\n        returnEmbeddedWallet,\n        startHeadlessEmbeddedWalletCreationFlow,\n        startPasskeyEmbeddedWalletCreationFlow,\n        walletConnectorOptions,\n        setPrimaryWalletId,\n    ]);\n    return {\n        createTurnkeyWallet,\n    };\n};\n\nexport { useTurnkey };\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 385, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 391, "column": 0}, "map": {"version":3,"sources":["file:///home/sohail/mystuff/10-Work/projects/erc20saas/frontend/node_modules/%40dynamic-labs/sdk-react-core/src/lib/utils/hooks/useEmbeddedWallet/useSecureEnclaveEmbeddedWallet/useSecureEnclaveEmbeddedWallet.js"],"sourcesContent":["'use client'\nimport { __awaiter } from '../../../../../../_virtual/_tslib.js';\nimport { useCallback, useMemo } from 'react';\nimport { JwtVerifiedCredentialFormatEnum } from '@dynamic-labs/sdk-api-core';\nimport { DynamicError, EmbeddedWalletException, StorageService } from '@dynamic-labs/utils';\nimport { isSessionKeyCompatibleWalletConnector } from '@dynamic-labs/wallet-connector-core';\nimport '../../../../context/DynamicContext/DynamicContext.js';\nimport { logger } from '../../../../shared/logger.js';\nimport '@dynamic-labs/iconic';\nimport 'react/jsx-runtime';\nimport '../../../../context/ViewContext/ViewContext.js';\nimport '@dynamic-labs/wallet-book';\nimport { EMBEDDED_WALLET_SESSION_SETTINGS } from '../../../constants/localStorage.js';\nimport '../../../constants/colors.js';\nimport '../../../constants/values.js';\nimport '../../../../store/state/loadingAndLifecycle.js';\nimport '../../../../shared/consts/index.js';\nimport '../../../../events/dynamicEvents.js';\nimport '../../../../context/CaptchaContext/CaptchaContext.js';\nimport '../../../../context/ErrorContext/ErrorContext.js';\nimport { findEmbeddedWalletFromVerifiedCredentials } from '../../../functions/findEmbeddedWalletFromVerifiedCredentials/findEmbeddedWalletFromVerifiedCredentials.js';\nimport { findTurnkeyWalletByPrimaryChain } from '../../../functions/findTurnkeyWallet/findTurnkeyWallet.js';\nimport '@dynamic-labs/multi-wallet';\nimport 'react-international-phone';\nimport { getUserWalletsFromVerifiedCredentials } from '../../../functions/getUserWalletsFromVerifiedCredentials/getUserWalletsFromVerifiedCredentials.js';\nimport { addPasskeyIdentifierToWalletConnector } from '../../../functions/addPasskeyIdentifierToWalletConnector/addPasskeyIdentifierToWalletConnector.js';\nimport '../../../../config/ApiEndpoint.js';\nimport { getCreateEmbeddedWalletAccountRequest, createEmbeddedWalletAccount, completePasskeyRecovery, getUserPasskeys, initEmbeddedWalletSession } from '../../../../data/api/embeddedWallets/embeddedWallets.js';\nimport '../../../../store/state/user/user.js';\nimport '../../../../locale/locale.js';\nimport { refreshUserJwt } from '../../../../data/api/user/user.js';\nimport { getUserVerifiedCredentialType } from '../../../functions/getUserVerifiedCredentialType/getUserVerifiedCredentialType.js';\nimport { hasEmbeddedWallet } from '../../../functions/hasEmbeddedWallet/hasEmbeddedWallet.js';\nimport { getEmbeddedWalletAuthHandler } from '../../../functions/getEmbeddedWalletAuthHandler/getEmbeddedWalletAuthHandler.js';\nimport { getEmbeddedWalletSessionExpiration } from '../../../functions/getEmbeddedWalletSessionExpiration/getEmbeddedWalletSessionExpiration.js';\nimport '../../../../store/state/projectSettings/projectSettings.js';\nimport '../../../../context/AccessDeniedContext/AccessDeniedContext.js';\nimport '../../../../context/AccountExistsContext/AccountExistsContext.js';\nimport '../../../../context/UserWalletsContext/UserWalletsContext.js';\nimport { USER_NOT_LOGGED_IN, ACTIVE_SESSION, SESSION_RESTORED, INVALID_REQUEST, INVALID_WALLET_DATA, SESSION_CREATED, ERROR_SENDING_CODE, CODE_SENT } from '../../../constants/errors.js';\nimport '../../../../context/VerificationContext/VerificationContext.js';\nimport 'react-dom';\nimport { useElementById } from '../../useElementById/useElementById.js';\nimport { findPrimaryEmbeddedChain } from '../../../../views/Passkey/utils/findPrimaryEmbeddedChain/findPrimaryEmbeddedChain.js';\nimport { useWalletContext } from '../../../../context/WalletContext/WalletContext.js';\nimport { useIsTurnkeyWallet } from '../../useIsTurnkeyWallet/useIsTurnkeyWallet.js';\nimport { cleanupExport, initExport, exportCredential } from '../../../../views/EmbeddedReveal/utils/turnkeyExport/turnkeyExport.js';\nimport { canRestoreEmbeddedWalletSession, restoreEmbeddedWalletSession } from '../../../../views/Passkey/utils/passkeyRecovery/passkeyRecovery.js';\nimport { validateTurnkeyProviderEnabled } from '../../../validations/validateTurnkeyProviderEnabled/validateTurnkeyProviderEnabled.js';\nimport { usePasskeyRecovery } from '../../usePasskeyRecovery/usePasskeyRecovery.js';\nimport { useSmartWallets } from '../../useSmartWallets/useSmartWallets.js';\nimport { EmbeddedWalletVersion, iframeContainerId, iframeElementId, revealIframeElementId, revealIframeContainerId } from './constants.js';\nimport { useTurnkey } from './useTurnkey/useTurnkey.js';\nimport '../../../../context/ThemeContext/ThemeContext.js';\nimport '../../useUserUpdateRequest/useUpdateUser/userFieldsSchema.js';\nimport '@dynamic-labs/types';\nimport '../../../../context/LoadingContext/LoadingContext.js';\nimport 'yup';\nimport '../../../../context/MockContext/MockContext.js';\nimport '../../../../views/CollectUserDataView/useFields.js';\nimport '../../../../context/FieldsStateContext/FieldsStateContext.js';\nimport '../../../../context/UserFieldEditorContext/UserFieldEditorContext.js';\nimport '@dynamic-labs/rpc-providers';\nimport '../../../../store/state/environmentId.js';\nimport '../../../../store/state/walletConnectorOptions.js';\nimport 'react-i18next';\nimport '../../../../components/Accordion/components/AccordionItem/AccordionItem.js';\nimport '../../../../components/Alert/Alert.js';\nimport '../../../../components/ShadowDOM/ShadowDOM.js';\nimport '../../../../components/IconButton/IconButton.js';\nimport '../../../../components/InlineWidget/InlineWidget.js';\nimport '../../../../components/Input/Input.js';\nimport '../../../../components/IsBrowser/IsBrowser.js';\nimport '../../../../components/MenuList/Dropdown/Dropdown.js';\nimport '../../../../components/Transition/ZoomTransition/ZoomTransition.js';\nimport '../../../../components/Transition/SlideInUpTransition/SlideInUpTransition.js';\nimport '../../../../components/Transition/OpacityTransition/OpacityTransition.js';\nimport '../../../../components/OverlayCard/OverlayCardTarget/OverlayCardTarget.js';\nimport '../../../../components/PasskeyCreatedSuccessBanner/PasskeyCreatedSuccessBanner.js';\nimport '../../../../components/Popper/Popper/Popper.js';\nimport '../../../../components/Popper/PopperContext/PopperContext.js';\nimport 'react-focus-lock';\nimport 'qrcode';\nimport 'formik';\nimport '../../../../context/FooterAnimationContext/index.js';\nimport '../../../../context/WalletGroupContext/WalletGroupContext.js';\nimport '../../../../context/IpConfigurationContext/IpConfigurationContext.js';\nimport '../../../../context/SocialRedirectContext/SocialRedirectContext.js';\nimport '../../../../widgets/DynamicBridgeWidget/views/WalletsView/components/SecondaryWallets/SecondaryWallets.js';\nimport '@hcaptcha/react-hcaptcha';\nimport '../../../../widgets/DynamicWidget/context/DynamicWidgetContext.js';\nimport '../../../../context/PasskeyContext/PasskeyContext.js';\nimport '../../../../store/state/sendBalances.js';\nimport '../../../../widgets/DynamicWidget/components/DynamicWidgetHeader/DynamicWidgetHeader.js';\nimport '../../../../views/TransactionConfirmationView/TransactionConfirmationView.js';\nimport '../../../../widgets/DynamicWidget/views/ManagePasskeysWidgetView/PasskeyCard/PasskeyCard.js';\nimport '../../../../../index.js';\nimport '../../../../store/state/tokenBalances.js';\nimport '../../../../shared/utils/functions/getInitialUrl/getInitialUrl.js';\nimport { useInternalDynamicContext } from '../../../../context/DynamicContext/useDynamicContext/useInternalDynamicContext.js';\n\nconst isConnectorSessionKeyActive = (connector) => {\n    var _a;\n    if (!connector || !isSessionKeyCompatibleWalletConnector(connector))\n        return false;\n    return Boolean((_a = connector.sessionKeys) === null || _a === void 0 ? void 0 : _a.publicKey);\n};\n// Hook exposed to customers\n/**\n *\n * @returns {\n * createEmbeddedWallet, - creates Secure enclave embedded wallet according to the settings\n * createOrRestoreSession, - creates or restores a embedded wallet session\n * createPasskey, - creates a new passkey both for an existing wallet or a wallet to be created\n * getPasskeys, - gets all passkeys for the user\n * isLoadingEmbeddedWallet, - loading state of the embedded wallet\n * isSessionActive, - checks if the embedded wallet session is active\n * revealEmbeddedWalletKey - export the recovery phrase or private key of the embedded wallet\n * sendOneTimeCode, - sends a one-time code to the user so they can create a session or add a new passkey\n * userHasEmbeddedWallet, - checks if the user has an embedded wallet\n * }\n */\nconst useSecureEnclaveEmbeddedWallet = () => {\n    var _a, _b, _c, _d;\n    const { projectSettings, primaryWallet, user, environmentId, walletConnectorOptions, } = useInternalDynamicContext();\n    const { createTurnkeyWallet } = useTurnkey();\n    const { hasRecoveryEmail } = useIsTurnkeyWallet();\n    const { createRootElement } = useElementById();\n    const { isLoadingEmbeddedWallet, setIsLoadingEmbeddedWallet } = useWalletContext();\n    const { getEOAWallet } = useSmartWallets();\n    const wallet = (_a = (primaryWallet && getEOAWallet(primaryWallet))) !== null && _a !== void 0 ? _a : primaryWallet;\n    const userHasEmbeddedWallet = useCallback(() => hasEmbeddedWallet(user, 'turnkey'), [user]);\n    const getWalletVersion = useCallback(() => {\n        if (isSessionKeyCompatibleWalletConnector(wallet === null || wallet === void 0 ? void 0 : wallet.connector)) {\n            return EmbeddedWalletVersion.V2;\n        }\n        return EmbeddedWalletVersion.V1;\n    }, [wallet === null || wallet === void 0 ? void 0 : wallet.connector]);\n    const { shouldInitRecovery, initPasskeyRecoveryProcess } = usePasskeyRecovery();\n    /**\n     * Creates a new secure enclave embedded wallet according to the settings from the dashboard\n     * @param chain - optional chain parameter to create the wallet for\n     * @param options - optional parameter contained more settings for the wallet creation\n     * @returns Promise<Wallet | undefined>\n     */\n    const createEmbeddedWallet = useCallback((chains, options) => __awaiter(void 0, void 0, void 0, function* () {\n        var _e;\n        if (!user) {\n            throw new DynamicError(USER_NOT_LOGGED_IN);\n        }\n        const userWalletsCredentials = getUserWalletsFromVerifiedCredentials(user);\n        const primaryChain = findPrimaryEmbeddedChain(projectSettings);\n        const embeddedWalletVerifiedCredential = findEmbeddedWalletFromVerifiedCredentials(user, chains !== null && chains !== void 0 ? chains : [primaryChain]);\n        const isManualMode = ((_e = projectSettings === null || projectSettings === void 0 ? void 0 : projectSettings.sdk.embeddedWallets) === null || _e === void 0 ? void 0 : _e.automaticEmbeddedWalletCreation) === false;\n        // if user has a wallet and it's not embedded,\n        // throw error to follow another flow and set up the right wallet\n        // However, if the user is in manual mode continue.\n        if ((userWalletsCredentials === null || userWalletsCredentials === void 0 ? void 0 : userWalletsCredentials.length) &&\n            !embeddedWalletVerifiedCredential &&\n            !isManualMode) {\n            throw new EmbeddedWalletException('User already has a linked branded wallet, and manual mode creation is not enabled.');\n        }\n        validateTurnkeyProviderEnabled(projectSettings);\n        // TEMP: immediately disable loading state\n        setIsLoadingEmbeddedWallet(false);\n        return createTurnkeyWallet(chains, options);\n    }), [createTurnkeyWallet, projectSettings, setIsLoadingEmbeddedWallet, user]);\n    /**\n     * Creates a new secure enclave embedded wallet account\n     * @param chain - chain parameter to create the wallet for\n     * @returns Promise<UserProfile | undefined>\n     */\n    const createEmbeddedWalletAccount$1 = useCallback((_f) => __awaiter(void 0, [_f], void 0, function* ({ chain }) {\n        var _g, _h, _j;\n        if (!user) {\n            throw new Error(USER_NOT_LOGGED_IN);\n        }\n        validateTurnkeyProviderEnabled(projectSettings);\n        const primaryChain = findPrimaryEmbeddedChain(projectSettings);\n        const embeddedWalletVerifiedCredential = findEmbeddedWalletFromVerifiedCredentials(user, [primaryChain]);\n        const turnkeyWalletId = (_g = embeddedWalletVerifiedCredential === null || embeddedWalletVerifiedCredential === void 0 ? void 0 : embeddedWalletVerifiedCredential.walletProperties) === null || _g === void 0 ? void 0 : _g.turnkeyHDWalletId;\n        if (!turnkeyWalletId) {\n            throw new DynamicError('No HD wallet was found for this user to derive a wallet account. Use createEmbeddedWallet first', 'NoHdWalletFound');\n        }\n        const requestToStamp = yield getCreateEmbeddedWalletAccountRequest({\n            chain,\n            environmentId,\n        });\n        if (isSessionKeyCompatibleWalletConnector(wallet === null || wallet === void 0 ? void 0 : wallet.connector)) {\n            yield ((_h = wallet === null || wallet === void 0 ? void 0 : wallet.connector) === null || _h === void 0 ? void 0 : _h.createOrRestoreSession({\n                ignoreRestore: true,\n            }));\n        }\n        else if (yield shouldInitRecovery()) {\n            yield initPasskeyRecoveryProcess('email');\n        }\n        const signedRequest = yield ((_j = wallet === null || wallet === void 0 ? void 0 : wallet.connector) === null || _j === void 0 ? void 0 : _j.stampCreateWalletAccountRequest({\n            request: requestToStamp,\n        }));\n        yield createEmbeddedWalletAccount({\n            createEmbeddedWalletAccountRequest: signedRequest,\n            environmentId,\n        });\n        return refreshUserJwt({ environmentId });\n    }), [\n        environmentId,\n        wallet === null || wallet === void 0 ? void 0 : wallet.connector,\n        initPasskeyRecoveryProcess,\n        projectSettings,\n        shouldInitRecovery,\n        user,\n    ]);\n    /**\n     * Creates or restores a secure enclave embedded wallet session\n     * If it detects that the session is possible to be restored, it will restore it\n     * @param oneTimeCode - optional one-time code parameter. If not informed it tries to restore a session\n     * @returns Promise<'session_created' | 'session_restored'> - returns a string indicating the status of the session\n     */\n    const createOrRestoreSession = useCallback((options) => __awaiter(void 0, void 0, void 0, function* () {\n        var _k, _l, _m, _o, _p, _q;\n        if (!user) {\n            throw new DynamicError(USER_NOT_LOGGED_IN);\n        }\n        const primaryConnector = primaryWallet === null || primaryWallet === void 0 ? void 0 : primaryWallet.connector;\n        if (primaryConnector &&\n            isSessionKeyCompatibleWalletConnector(primaryConnector)) {\n            return primaryConnector.createOrRestoreSession();\n        }\n        const eoaConnector = wallet === null || wallet === void 0 ? void 0 : wallet.connector;\n        if (eoaConnector && isSessionKeyCompatibleWalletConnector(eoaConnector)) {\n            return eoaConnector.createOrRestoreSession();\n        }\n        const turnkeyRecoveryHandler = getEmbeddedWalletAuthHandler(wallet === null || wallet === void 0 ? void 0 : wallet.connector);\n        if (turnkeyRecoveryHandler.isSessionActive()) {\n            return ACTIVE_SESSION;\n        }\n        const turnkeyAuthIframeContainerRef = createRootElement(iframeContainerId);\n        // try to restore session if possible\n        if (canRestoreEmbeddedWalletSession((_k = projectSettings === null || projectSettings === void 0 ? void 0 : projectSettings.sdk.embeddedWallets) === null || _k === void 0 ? void 0 : _k.sessionKeyDuration)) {\n            try {\n                const sessionRestored = yield restoreEmbeddedWalletSession({\n                    iframeContainer: turnkeyAuthIframeContainerRef.current,\n                    iframeElementId,\n                    sessionExpiration: getEmbeddedWalletSessionExpiration((_m = (_l = projectSettings === null || projectSettings === void 0 ? void 0 : projectSettings.sdk) === null || _l === void 0 ? void 0 : _l.embeddedWallets) === null || _m === void 0 ? void 0 : _m.sessionKeyDuration),\n                    user,\n                    wallet: primaryWallet,\n                });\n                if (sessionRestored)\n                    return SESSION_RESTORED;\n            }\n            catch (err) {\n                logger.error('Failed to restore embedded wallet', err);\n            }\n        }\n        if (!(options === null || options === void 0 ? void 0 : options.oneTimeCode)) {\n            throw new DynamicError('One-time code is required to create a session.', INVALID_REQUEST);\n        }\n        // tries to create a new session with the informed one-time code\n        // verify user has a turnkey wallet and email VC\n        if (!userHasEmbeddedWallet() || !hasRecoveryEmail) {\n            throw new DynamicError('User does not have a secure enclave wallet or a verified email', INVALID_WALLET_DATA);\n        }\n        const organizationId = (_q = (_p = (_o = user === null || user === void 0 ? void 0 : user.verifiedCredentials) === null || _o === void 0 ? void 0 : _o.find(({ walletName }) => walletName === null || walletName === void 0 ? void 0 : walletName.startsWith('turnkey'))) === null || _p === void 0 ? void 0 : _p.walletProperties) === null || _q === void 0 ? void 0 : _q.turnkeySubOrganizationId;\n        yield turnkeyRecoveryHandler.verifyRecoveryCode(options.oneTimeCode, organizationId);\n        const sessionSettings = {\n            createdAt: new Date().getTime(),\n            emailCode: options.oneTimeCode,\n            userId: turnkeyRecoveryHandler.recoveryUserId,\n        };\n        StorageService.setItem(EMBEDDED_WALLET_SESSION_SETTINGS, sessionSettings);\n        return SESSION_CREATED;\n    }), [\n        createRootElement,\n        user,\n        hasRecoveryEmail,\n        primaryWallet,\n        (_c = (_b = projectSettings === null || projectSettings === void 0 ? void 0 : projectSettings.sdk) === null || _b === void 0 ? void 0 : _b.embeddedWallets) === null || _c === void 0 ? void 0 : _c.sessionKeyDuration,\n        userHasEmbeddedWallet,\n        wallet === null || wallet === void 0 ? void 0 : wallet.connector,\n    ]);\n    /**\n     * Creates a new passkey both for an existing wallet or a wallet to be created\n     * @param options - optional parameter to inform a one-time code to create a session,\n     * @returns Promise<WebAuthnAttestation>\n     */\n    const createPasskey = useCallback((options) => __awaiter(void 0, void 0, void 0, function* () {\n        var _r, _s;\n        if (!user) {\n            throw new DynamicError(USER_NOT_LOGGED_IN);\n        }\n        validateTurnkeyProviderEnabled(projectSettings);\n        const turnkeyWallet = findTurnkeyWalletByPrimaryChain(walletConnectorOptions, (_r = projectSettings === null || projectSettings === void 0 ? void 0 : projectSettings.sdk.embeddedWallets) === null || _r === void 0 ? void 0 : _r.chainConfigurations, user.verifiedCredentials);\n        if (!(turnkeyWallet === null || turnkeyWallet === void 0 ? void 0 : turnkeyWallet.walletConnector)) {\n            throw new DynamicError('Wallet connector not found', INVALID_WALLET_DATA);\n        }\n        const walletConnector = turnkeyWallet.walletConnector;\n        walletConnector.setEmail(user === null || user === void 0 ? void 0 : user.email);\n        if (user && !(user === null || user === void 0 ? void 0 : user.email)) {\n            addPasskeyIdentifierToWalletConnector(walletConnector, user);\n        }\n        const hasEmailVC = getUserVerifiedCredentialType(user, JwtVerifiedCredentialFormatEnum.Email);\n        // return a new passkey if the user doesn't have a wallet yet or\n        // none of the requirements to add a passkey to an existing wallet are met\n        if (!('id' in turnkeyWallet) || !hasEmailVC) {\n            return walletConnector.getWebAuthnAttestation();\n        }\n        const turnkeySubOrganizationId = (_s = turnkeyWallet === null || turnkeyWallet === void 0 ? void 0 : turnkeyWallet.walletProperties) === null || _s === void 0 ? void 0 : _s.turnkeySubOrganizationId;\n        if (!turnkeySubOrganizationId) {\n            throw new DynamicError('No sub organization id found for the wallet', INVALID_WALLET_DATA);\n        }\n        const turnkAuthenticatorHandler = getEmbeddedWalletAuthHandler(walletConnector);\n        // add new passkey to the wallet through an active session\n        yield createOrRestoreSession(options);\n        const { attestation, challenge, displayName } = yield walletConnector.getWebAuthnAttestation();\n        yield turnkAuthenticatorHandler.addPasskeyAuthenticator({\n            attestation,\n            challenge,\n            turnkeySubOrganizationId,\n        });\n        const updatedUser = yield completePasskeyRecovery({\n            attestation: attestation,\n            challenge,\n            environmentId,\n            walletId: turnkeyWallet === null || turnkeyWallet === void 0 ? void 0 : turnkeyWallet.id,\n        });\n        if (!updatedUser) {\n            throw new DynamicError('Error completing passkey recovery');\n        }\n        return { attestation, challenge, displayName };\n    }), [\n        createOrRestoreSession,\n        environmentId,\n        projectSettings,\n        user,\n        walletConnectorOptions,\n    ]);\n    /**\n     * Gets all passkeys for the user\n     * @returns Promise<Passkey[]>\n     */\n    const getPasskeys = useCallback(() => __awaiter(void 0, void 0, void 0, function* () {\n        if (!user) {\n            throw new DynamicError(USER_NOT_LOGGED_IN);\n        }\n        const data = yield getUserPasskeys({\n            environmentId: environmentId,\n        });\n        return data.passkeys;\n    }), [user, environmentId]);\n    const isEmailAuthSessionActive = useMemo(() => {\n        var _a;\n        const eoaConnector = wallet === null || wallet === void 0 ? void 0 : wallet.connector;\n        if (!eoaConnector || !('getAuthenticatorHandler' in eoaConnector))\n            return false;\n        return (_a = getEmbeddedWalletAuthHandler(eoaConnector)) === null || _a === void 0 ? void 0 : _a.isSessionActive();\n    }, [wallet === null || wallet === void 0 ? void 0 : wallet.connector]);\n    const isSessionKeySessionAAActive = useMemo(() => isConnectorSessionKeyActive(wallet === null || wallet === void 0 ? void 0 : wallet.connector), [wallet === null || wallet === void 0 ? void 0 : wallet.connector]);\n    const isSessionKeySessionActive = useMemo(() => isConnectorSessionKeyActive(primaryWallet === null || primaryWallet === void 0 ? void 0 : primaryWallet.connector), [primaryWallet === null || primaryWallet === void 0 ? void 0 : primaryWallet.connector]);\n    /**\n     * Checks if the embedded wallet session is active\n     */\n    const isSessionActive = isEmailAuthSessionActive ||\n        isSessionKeySessionActive ||\n        isSessionKeySessionAAActive;\n    /**\n     * export the recovery phrase or private key of the embedded wallet\n     * @param options - optional parameter object containing the type of key to reveal 'recoveryPhrase' | 'privateKey'\n     * and the html container id to render the iframe into\n     * @returns Promise<string> - returns the embedded wallet recovery phrase or private key\n     */\n    const revealEmbeddedWalletKey = useCallback((_t) => __awaiter(void 0, [_t], void 0, function* ({ type, htmlContainerId, }) {\n        var _u, _v, _w, _x, _y, _z;\n        if (!user) {\n            throw new DynamicError(USER_NOT_LOGGED_IN);\n        }\n        yield cleanupExport({\n            wallet: wallet,\n        });\n        const turnkeyWallet = findTurnkeyWalletByPrimaryChain(walletConnectorOptions, (_u = projectSettings === null || projectSettings === void 0 ? void 0 : projectSettings.sdk.embeddedWallets) === null || _u === void 0 ? void 0 : _u.chainConfigurations, user === null || user === void 0 ? void 0 : user.verifiedCredentials);\n        const turnkeyHDWalletId = (_v = turnkeyWallet === null || turnkeyWallet === void 0 ? void 0 : turnkeyWallet.walletProperties) === null || _v === void 0 ? void 0 : _v.turnkeyHDWalletId;\n        if (type === 'recoveryPhrase' && !turnkeyHDWalletId) {\n            type = 'privateKey';\n        }\n        const iframeContainerElement = createRootElement(revealIframeElementId, htmlContainerId || revealIframeContainerId);\n        // hide the iframe container until the export is done\n        // since it will show unrelated turnkey content\n        iframeContainerElement.current.style.display = 'none';\n        if (isSessionKeyCompatibleWalletConnector(wallet === null || wallet === void 0 ? void 0 : wallet.connector)) {\n            yield ((_w = wallet === null || wallet === void 0 ? void 0 : wallet.connector) === null || _w === void 0 ? void 0 : _w.createOrRestoreSession());\n        }\n        yield initExport({\n            iframeContainer: iframeContainerElement.current,\n            iframeElementId: revealIframeElementId,\n            wallet: wallet,\n        });\n        try {\n            yield exportCredential({\n                address: type === 'privateKey' ? wallet === null || wallet === void 0 ? void 0 : wallet.address : undefined,\n                environmentId,\n                user,\n                wallet: wallet,\n            });\n        }\n        catch (_0) {\n            if (isSessionKeyCompatibleWalletConnector(wallet === null || wallet === void 0 ? void 0 : wallet.connector) &&\n                ((_x = wallet === null || wallet === void 0 ? void 0 : wallet.connector) === null || _x === void 0 ? void 0 : _x.removeSessionKeys)) {\n                yield ((_y = wallet === null || wallet === void 0 ? void 0 : wallet.connector) === null || _y === void 0 ? void 0 : _y.removeSessionKeys());\n                yield ((_z = wallet === null || wallet === void 0 ? void 0 : wallet.connector) === null || _z === void 0 ? void 0 : _z.createOrRestoreSession({\n                    ignoreRestore: true,\n                }));\n            }\n            yield exportCredential({\n                address: type === 'privateKey' ? wallet === null || wallet === void 0 ? void 0 : wallet.address : undefined,\n                environmentId,\n                user,\n                wallet: wallet,\n            });\n        }\n        // show the iframe container after the export is done\n        // to show the exported content only\n        iframeContainerElement.current.style.display = 'block';\n        return true;\n    }), [\n        createRootElement,\n        environmentId,\n        wallet,\n        (_d = projectSettings === null || projectSettings === void 0 ? void 0 : projectSettings.sdk.embeddedWallets) === null || _d === void 0 ? void 0 : _d.chainConfigurations,\n        user,\n        walletConnectorOptions,\n    ]);\n    /**\n     * Sends a one-time code to the user so they can create a session or add a new passkey\n     * @returns Promise<'code_sent'>\n     */\n    const sendOneTimeCode = useCallback(() => __awaiter(void 0, void 0, void 0, function* () {\n        var _1, _2;\n        if (!user) {\n            throw new DynamicError(USER_NOT_LOGGED_IN);\n        }\n        const targetTurnkeyWallet = findTurnkeyWalletByPrimaryChain(walletConnectorOptions, (_1 = projectSettings === null || projectSettings === void 0 ? void 0 : projectSettings.sdk.embeddedWallets) === null || _1 === void 0 ? void 0 : _1.chainConfigurations, user.verifiedCredentials);\n        if (!targetTurnkeyWallet || !('id' in targetTurnkeyWallet)) {\n            throw new DynamicError('User does not have a valid secure enclave wallet', INVALID_WALLET_DATA);\n        }\n        const turnkeyAuthenticatorHandler = getEmbeddedWalletAuthHandler(targetTurnkeyWallet === null || targetTurnkeyWallet === void 0 ? void 0 : targetTurnkeyWallet.walletConnector);\n        const targetTurnkeyWalletId = targetTurnkeyWallet.id;\n        const isSessionActive = turnkeyAuthenticatorHandler.isSessionActive();\n        if (isSessionActive) {\n            throw new DynamicError('Session is active. No need to create a new one', ACTIVE_SESSION);\n        }\n        const turnkeyAuthIframeContainerRef = createRootElement(iframeContainerId);\n        const publicKey = yield turnkeyAuthenticatorHandler.initRecovery('email', turnkeyAuthIframeContainerRef.current, iframeElementId, getEmbeddedWalletSessionExpiration((_2 = projectSettings === null || projectSettings === void 0 ? void 0 : projectSettings.sdk.embeddedWallets) === null || _2 === void 0 ? void 0 : _2.sessionKeyDuration));\n        if (!publicKey) {\n            throw new DynamicError(ERROR_SENDING_CODE);\n        }\n        const response = yield initEmbeddedWalletSession({\n            authenticatorType: 'email',\n            environmentId,\n            publicKey,\n            walletId: targetTurnkeyWalletId,\n        });\n        turnkeyAuthenticatorHandler.recoveryUserId = response.turnkeyUserId;\n        return CODE_SENT;\n    }), [\n        createRootElement,\n        user,\n        environmentId,\n        projectSettings,\n        walletConnectorOptions,\n    ]);\n    return useMemo(() => ({\n        createEmbeddedWallet,\n        createEmbeddedWalletAccount: createEmbeddedWalletAccount$1,\n        createOrRestoreSession,\n        createPasskey,\n        getPasskeys,\n        getWalletVersion,\n        isLoadingEmbeddedWallet,\n        isSessionActive,\n        revealEmbeddedWalletKey,\n        sendOneTimeCode,\n        userHasEmbeddedWallet,\n    }), [\n        createEmbeddedWallet,\n        createEmbeddedWalletAccount$1,\n        createOrRestoreSession,\n        createPasskey,\n        getPasskeys,\n        getWalletVersion,\n        isLoadingEmbeddedWallet,\n        isSessionActive,\n        revealEmbeddedWalletKey,\n        sendOneTimeCode,\n        userHasEmbeddedWallet,\n    ]);\n};\n\nexport { isConnectorSessionKeyActive, useSecureEnclaveEmbeddedWallet };\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 1004, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 1010, "column": 0}, "map": {"version":3,"sources":["file:///home/sohail/mystuff/10-Work/projects/erc20saas/frontend/node_modules/%40dynamic-labs/sdk-react-core/src/lib/utils/hooks/useEmbeddedWallet/useMPCEmbeddedWallet/useCoinbaseMPC/useCoinbaseMPC.js"],"sourcesContent":["'use client'\nimport { __awaiter } from '../../../../../../../_virtual/_tslib.js';\nimport { useCallback } from 'react';\nimport { PasswordSourceTypeEnum, EmbeddedWalletChainEnum } from '@dynamic-labs/sdk-api-core';\nimport { isCoinbaseMpcWalletConnector } from '@dynamic-labs/wallet-connector-core';\nimport { DynamicError } from '@dynamic-labs/utils';\nimport { createUserProfileFromSdkUser } from '../../../../functions/createUserProfile/createUserProfile.js';\nimport { findEmbeddedWalletFromVerifiedCredentials } from '../../../../functions/findEmbeddedWalletFromVerifiedCredentials/findEmbeddedWalletFromVerifiedCredentials.js';\nimport '../../../../constants/values.js';\nimport { USER_NOT_LOGGED_IN } from '../../../../constants/errors.js';\nimport '@dynamic-labs/multi-wallet';\nimport { logger } from '../../../../../shared/logger.js';\nimport '../../../../constants/colors.js';\nimport 'react-international-phone';\nimport '@dynamic-labs/iconic';\nimport 'react/jsx-runtime';\nimport '../../../../../context/ViewContext/ViewContext.js';\nimport '@dynamic-labs/wallet-book';\nimport { generateRandomPassword } from '../../../../../shared/utils/functions/generateRandomPassword/generateRandomPassword.js';\nimport '../../../../../store/state/loadingAndLifecycle.js';\nimport '../../../../../shared/consts/index.js';\nimport { getVerifyArgs } from '../../../../functions/getVerifyArgs/getVerifyArgs.js';\nimport { findCoinbaseMPCWallet } from '../../../../functions/findCoinbaseMPCWallet/findCoinbaseMPCWallet.js';\nimport { getCoinbaseMPCConnectorFetchers } from '../../../../functions/getCoinbaseMPCConnectorFetchers/getCoinbaseMPCConnectorFetchers.js';\nimport '../../../../../store/state/projectSettings/projectSettings.js';\nimport '../../../../../context/DynamicContext/DynamicContext.js';\nimport { dynamicEvents } from '../../../../../events/dynamicEvents.js';\nimport '../../../../../context/CaptchaContext/CaptchaContext.js';\nimport { useErrorContext } from '../../../../../context/ErrorContext/ErrorContext.js';\nimport '../../../../../context/AccessDeniedContext/AccessDeniedContext.js';\nimport '../../../../../context/AccountExistsContext/AccountExistsContext.js';\nimport '../../../../../context/UserWalletsContext/UserWalletsContext.js';\nimport '../../../../../config/ApiEndpoint.js';\nimport '../../../../../store/state/user/user.js';\nimport '../../../../../locale/locale.js';\nimport { linkWallet } from '../../../../../data/api/wallets/wallets.js';\nimport { getSiweStatement } from '../../../../functions/getSiweStatement/getSiweStatement.js';\nimport '../../../../../context/VerificationContext/VerificationContext.js';\nimport 'react-dom';\nimport '../../../../../context/WalletContext/WalletContext.js';\nimport '../../useSecureEnclaveEmbeddedWallet/constants.js';\nimport '../../../../../context/ThemeContext/ThemeContext.js';\nimport '../../../useUserUpdateRequest/useUpdateUser/userFieldsSchema.js';\nimport '@dynamic-labs/types';\nimport '../../../../../context/LoadingContext/LoadingContext.js';\nimport 'yup';\nimport '../../../../../context/MockContext/MockContext.js';\nimport '../../../../../views/CollectUserDataView/useFields.js';\nimport '../../../../../context/FieldsStateContext/FieldsStateContext.js';\nimport '../../../../../context/UserFieldEditorContext/UserFieldEditorContext.js';\nimport '@dynamic-labs/rpc-providers';\nimport '../../../../../store/state/environmentId.js';\nimport '../../../../../store/state/walletConnectorOptions.js';\nimport 'react-i18next';\nimport '../../../../../components/Accordion/components/AccordionItem/AccordionItem.js';\nimport '../../../../../components/Alert/Alert.js';\nimport '../../../../../components/ShadowDOM/ShadowDOM.js';\nimport '../../../../../components/IconButton/IconButton.js';\nimport '../../../../../components/InlineWidget/InlineWidget.js';\nimport '../../../../../components/Input/Input.js';\nimport '../../../../../components/IsBrowser/IsBrowser.js';\nimport '../../../../../components/MenuList/Dropdown/Dropdown.js';\nimport '../../../../../components/Transition/ZoomTransition/ZoomTransition.js';\nimport '../../../../../components/Transition/SlideInUpTransition/SlideInUpTransition.js';\nimport '../../../../../components/Transition/OpacityTransition/OpacityTransition.js';\nimport '../../../../../components/OverlayCard/OverlayCardTarget/OverlayCardTarget.js';\nimport '../../../../../components/PasskeyCreatedSuccessBanner/PasskeyCreatedSuccessBanner.js';\nimport '../../../../../components/Popper/Popper/Popper.js';\nimport '../../../../../components/Popper/PopperContext/PopperContext.js';\nimport 'react-focus-lock';\nimport 'qrcode';\nimport 'formik';\nimport '../../../../../context/FooterAnimationContext/index.js';\nimport '../../../../../context/WalletGroupContext/WalletGroupContext.js';\nimport '../../../../../context/IpConfigurationContext/IpConfigurationContext.js';\nimport '../../../../../context/SocialRedirectContext/SocialRedirectContext.js';\nimport '../../../../../widgets/DynamicBridgeWidget/views/WalletsView/components/SecondaryWallets/SecondaryWallets.js';\nimport '@hcaptcha/react-hcaptcha';\nimport '../../../../../widgets/DynamicWidget/context/DynamicWidgetContext.js';\nimport '../../../../../context/PasskeyContext/PasskeyContext.js';\nimport '../../../../../store/state/sendBalances.js';\nimport '../../../../../widgets/DynamicWidget/components/DynamicWidgetHeader/DynamicWidgetHeader.js';\nimport '../../../../../views/TransactionConfirmationView/TransactionConfirmationView.js';\nimport '../../../../../widgets/DynamicWidget/views/ManagePasskeysWidgetView/PasskeyCard/PasskeyCard.js';\nimport '../../../../../../index.js';\nimport '../../../../../store/state/tokenBalances.js';\nimport '../../../../../shared/utils/functions/getInitialUrl/getInitialUrl.js';\nimport { useInternalDynamicContext } from '../../../../../context/DynamicContext/useDynamicContext/useInternalDynamicContext.js';\n\nconst DYNAMIC_PASSWORD_LENGTH = 20;\nconst useCoinbaseMPC = () => {\n    const { user, setPrimaryWalletId, walletConnectorOptions, environmentId, consumeNonce, displaySiweStatement, appName, siweStatement, handleLogOut, setShowAuthFlow, } = useInternalDynamicContext();\n    const { setError } = useErrorContext();\n    const returnExistingCoinbaseMPCWallet = useCallback((validatedUser, connector, embeddedWalletVerifiedCredential) => __awaiter(void 0, void 0, void 0, function* () {\n        var _a;\n        connector.setVerifiedCredentials(validatedUser.verifiedCredentials);\n        setPrimaryWalletId(embeddedWalletVerifiedCredential.id);\n        const coinbaseMPCWallet = connector.createWallet({\n            address: (yield (connector === null || connector === void 0 ? void 0 : connector.getAddress())) || '',\n            chain: connector.connectedChain,\n            connector,\n            id: embeddedWalletVerifiedCredential.id,\n            isAuthenticated: true,\n            key: (_a = embeddedWalletVerifiedCredential.walletName) !== null && _a !== void 0 ? _a : connector.key,\n        });\n        return coinbaseMPCWallet;\n    }), [setPrimaryWalletId]);\n    const linkCoinbaseMPCWallet = useCallback((_b) => __awaiter(void 0, [_b], void 0, function* ({ connector, backupCode, password, source, }) {\n        const nonce = consumeNonce();\n        if (nonce === undefined)\n            throw new DynamicError('Missing nonce');\n        const address = yield connector.getAddress();\n        if (!address)\n            throw new DynamicError('Missing address');\n        const verifyArgs = yield getVerifyArgs({\n            displaySiweStatement,\n            environmentId,\n            nonce,\n            publicWalletAddress: address,\n            siweStatement: getSiweStatement({ appName, siweStatement }),\n            walletConnector: connector,\n            walletProvider: 'embeddedWallet',\n        });\n        const passcodeArgs = source === PasswordSourceTypeEnum.Dynamic\n            ? { password, passwordSource: source }\n            : {};\n        const response = yield linkWallet(environmentId, Object.assign(Object.assign(Object.assign({}, passcodeArgs), verifyArgs), { backup: backupCode }));\n        if (!response) {\n            throw new DynamicError('Unable to link wallet');\n        }\n        const updatedUserProfile = createUserProfileFromSdkUser(response.user);\n        const newSelectedCredentialWallet = updatedUserProfile.verifiedCredentials.find((cred) => cred.id === updatedUserProfile.lastVerifiedCredentialId &&\n            cred.format === 'blockchain');\n        if (!newSelectedCredentialWallet) {\n            throw new DynamicError('No primary wallet found');\n        }\n        setPrimaryWalletId(newSelectedCredentialWallet.id);\n        connector.setVerifiedCredentials(updatedUserProfile.verifiedCredentials);\n        return { newSelectedCredentialWallet, updatedUser: updatedUserProfile };\n    }), [\n        appName,\n        consumeNonce,\n        displaySiweStatement,\n        environmentId,\n        setPrimaryWalletId,\n        siweStatement,\n    ]);\n    const createNewCoinbaseMPCWallet = useCallback((connector, password) => __awaiter(void 0, void 0, void 0, function* () {\n        var _c;\n        const initialWalletPassword = password\n            ? password\n            : generateRandomPassword(DYNAMIC_PASSWORD_LENGTH);\n        const source = password\n            ? PasswordSourceTypeEnum.User\n            : PasswordSourceTypeEnum.Dynamic;\n        try {\n            const backupCode = yield connector.generateWallet(source, initialWalletPassword);\n            const { updatedUser, newSelectedCredentialWallet } = yield linkCoinbaseMPCWallet({\n                backupCode,\n                connector,\n                password: initialWalletPassword,\n                source,\n            });\n            const coinbaseMPCWallet = connector.createWallet({\n                address: (yield (connector === null || connector === void 0 ? void 0 : connector.getAddress())) || '',\n                chain: connector === null || connector === void 0 ? void 0 : connector.connectedChain,\n                connector,\n                id: newSelectedCredentialWallet.id,\n                isAuthenticated: true,\n                key: (_c = newSelectedCredentialWallet.walletName) !== null && _c !== void 0 ? _c : connector.key,\n            });\n            dynamicEvents.emit('embeddedWalletCreated', coinbaseMPCWallet, newSelectedCredentialWallet, updatedUser);\n            return coinbaseMPCWallet;\n        }\n        catch (error) {\n            logger.error(error);\n            if (error instanceof DynamicError &&\n                error.code === 'create_embedded_wallet_error') {\n                yield handleLogOut();\n                setError(error.message);\n            }\n        }\n        return undefined;\n    }), [linkCoinbaseMPCWallet, handleLogOut, setError]);\n    const createCoinbaseMPCWallet = useCallback((...args_1) => __awaiter(void 0, [...args_1], void 0, function* (chains = [EmbeddedWalletChainEnum.Evm], password) {\n        var _d;\n        if (!user) {\n            throw new DynamicError(USER_NOT_LOGGED_IN);\n        }\n        const connector = (_d = findCoinbaseMPCWallet(walletConnectorOptions)) === null || _d === void 0 ? void 0 : _d.walletConnector;\n        if (!connector || !isCoinbaseMpcWalletConnector(connector)) {\n            const error = new DynamicError('CoinbaseWaaSWalletConnectors not found');\n            logger.error('Failed to create embedded wallet', error);\n            dynamicEvents.emit('embeddedWalletFailed', error);\n            setError(error.message);\n            throw error;\n        }\n        setShowAuthFlow(false);\n        const { fetchAuthToken } = getCoinbaseMPCConnectorFetchers({\n            environmentId,\n        });\n        if (fetchAuthToken) {\n            connector.setAuthTokenFetcher(fetchAuthToken);\n        }\n        const embeddedWalletVerifiedCredential = findEmbeddedWalletFromVerifiedCredentials(user, chains);\n        // if user already has embedded wallet, set it as primary wallet and return\n        if (embeddedWalletVerifiedCredential) {\n            return returnExistingCoinbaseMPCWallet(user, connector, embeddedWalletVerifiedCredential);\n        }\n        return createNewCoinbaseMPCWallet(connector, password);\n    }), [\n        user,\n        walletConnectorOptions,\n        setShowAuthFlow,\n        environmentId,\n        createNewCoinbaseMPCWallet,\n        setError,\n        returnExistingCoinbaseMPCWallet,\n    ]);\n    return {\n        createCoinbaseMPCWallet,\n    };\n};\n\nexport { useCoinbaseMPC };\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 1338, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 1344, "column": 0}, "map": {"version":3,"sources":["file:///home/sohail/mystuff/10-Work/projects/erc20saas/frontend/node_modules/%40dynamic-labs/sdk-react-core/src/lib/utils/hooks/useEmbeddedWallet/useMPCEmbeddedWallet/useMPCEmbeddedWallet.js"],"sourcesContent":["'use client'\nimport { __awaiter } from '../../../../../../_virtual/_tslib.js';\nimport { useCallback } from 'react';\nimport { isCoinbaseMpcWalletConnector } from '@dynamic-labs/wallet-connector-core';\nimport { DynamicError, EmbeddedWalletException } from '@dynamic-labs/utils';\nimport '../../../../context/DynamicContext/DynamicContext.js';\nimport '@dynamic-labs/sdk-api-core';\nimport '../../../../shared/logger.js';\nimport '@dynamic-labs/iconic';\nimport 'react/jsx-runtime';\nimport '../../../../context/ViewContext/ViewContext.js';\nimport '@dynamic-labs/wallet-book';\nimport '../../../constants/colors.js';\nimport '../../../constants/values.js';\nimport '../../../../store/state/loadingAndLifecycle.js';\nimport '../../../../shared/consts/index.js';\nimport '../../../../events/dynamicEvents.js';\nimport '../../../../context/CaptchaContext/CaptchaContext.js';\nimport '../../../../context/ErrorContext/ErrorContext.js';\nimport { findEmbeddedWalletFromVerifiedCredentials } from '../../../functions/findEmbeddedWalletFromVerifiedCredentials/findEmbeddedWalletFromVerifiedCredentials.js';\nimport { USER_NOT_LOGGED_IN } from '../../../constants/errors.js';\nimport '@dynamic-labs/multi-wallet';\nimport 'react-international-phone';\nimport { getUserWalletsFromVerifiedCredentials } from '../../../functions/getUserWalletsFromVerifiedCredentials/getUserWalletsFromVerifiedCredentials.js';\nimport { findCoinbaseMPCWallet } from '../../../functions/findCoinbaseMPCWallet/findCoinbaseMPCWallet.js';\nimport { requiresPasswordForEmbeddedWallet } from '../../../functions/requiresPasswordForEmbeddedWallet/requiresPasswordForEmbeddedWallet.js';\nimport { requiresPasswordForEmbeddedWalletOnSignup } from '../../../functions/requiresPasswordForEmbeddedWalletOnSignup/requiresPasswordForEmbeddedWalletOnSignup.js';\nimport '../../../../config/ApiEndpoint.js';\nimport '../../../../store/state/user/user.js';\nimport '../../../../locale/locale.js';\nimport { hasEmbeddedWallet } from '../../../functions/hasEmbeddedWallet/hasEmbeddedWallet.js';\nimport '../../../../store/state/projectSettings/projectSettings.js';\nimport '../../../../context/AccessDeniedContext/AccessDeniedContext.js';\nimport '../../../../context/AccountExistsContext/AccountExistsContext.js';\nimport '../../../../context/UserWalletsContext/UserWalletsContext.js';\nimport '../../../../context/VerificationContext/VerificationContext.js';\nimport 'react-dom';\nimport { useWalletContext } from '../../../../context/WalletContext/WalletContext.js';\nimport { validateMPCProviderEnabled } from '../../../validations/validateMPCProviderEnabled/validateMPCProviderEnabled.js';\nimport '../useSecureEnclaveEmbeddedWallet/constants.js';\nimport { useEmbeddedWalletPassword } from '../../useEmbeddedWalletPassword/useEmbeddedWalletPassword.js';\nimport { useCoinbaseMPC } from './useCoinbaseMPC/useCoinbaseMPC.js';\nimport '../../../../context/ThemeContext/ThemeContext.js';\nimport '../../useUserUpdateRequest/useUpdateUser/userFieldsSchema.js';\nimport '@dynamic-labs/types';\nimport '../../../../context/LoadingContext/LoadingContext.js';\nimport 'yup';\nimport '../../../../context/MockContext/MockContext.js';\nimport '../../../../views/CollectUserDataView/useFields.js';\nimport '../../../../context/FieldsStateContext/FieldsStateContext.js';\nimport '../../../../context/UserFieldEditorContext/UserFieldEditorContext.js';\nimport '@dynamic-labs/rpc-providers';\nimport '../../../../store/state/environmentId.js';\nimport '../../../../store/state/walletConnectorOptions.js';\nimport 'react-i18next';\nimport '../../../../components/Accordion/components/AccordionItem/AccordionItem.js';\nimport '../../../../components/Alert/Alert.js';\nimport '../../../../components/ShadowDOM/ShadowDOM.js';\nimport '../../../../components/IconButton/IconButton.js';\nimport '../../../../components/InlineWidget/InlineWidget.js';\nimport '../../../../components/Input/Input.js';\nimport '../../../../components/IsBrowser/IsBrowser.js';\nimport '../../../../components/MenuList/Dropdown/Dropdown.js';\nimport '../../../../components/Transition/ZoomTransition/ZoomTransition.js';\nimport '../../../../components/Transition/SlideInUpTransition/SlideInUpTransition.js';\nimport '../../../../components/Transition/OpacityTransition/OpacityTransition.js';\nimport '../../../../components/OverlayCard/OverlayCardTarget/OverlayCardTarget.js';\nimport '../../../../components/PasskeyCreatedSuccessBanner/PasskeyCreatedSuccessBanner.js';\nimport '../../../../components/Popper/Popper/Popper.js';\nimport '../../../../components/Popper/PopperContext/PopperContext.js';\nimport 'react-focus-lock';\nimport 'qrcode';\nimport 'formik';\nimport '../../../../context/FooterAnimationContext/index.js';\nimport '../../../../context/WalletGroupContext/WalletGroupContext.js';\nimport '../../../../context/IpConfigurationContext/IpConfigurationContext.js';\nimport '../../../../context/SocialRedirectContext/SocialRedirectContext.js';\nimport '../../../../widgets/DynamicBridgeWidget/views/WalletsView/components/SecondaryWallets/SecondaryWallets.js';\nimport '@hcaptcha/react-hcaptcha';\nimport '../../../../widgets/DynamicWidget/context/DynamicWidgetContext.js';\nimport '../../../../context/PasskeyContext/PasskeyContext.js';\nimport '../../../../store/state/sendBalances.js';\nimport '../../../../widgets/DynamicWidget/components/DynamicWidgetHeader/DynamicWidgetHeader.js';\nimport '../../../../views/TransactionConfirmationView/TransactionConfirmationView.js';\nimport '../../../../widgets/DynamicWidget/views/ManagePasskeysWidgetView/PasskeyCard/PasskeyCard.js';\nimport '../../../../../index.js';\nimport '../../../../store/state/tokenBalances.js';\nimport '../../../../shared/utils/functions/getInitialUrl/getInitialUrl.js';\nimport { useInternalDynamicContext } from '../../../../context/DynamicContext/useDynamicContext/useInternalDynamicContext.js';\n\n// Hook exposed to customers and used internally to trigger embedded wallet creation\n/**\n * @returns {\n *  createEmbeddedWallet, - creates Dynamic or MPC embedded wallet according to the settings\n *  createPassword, - creates MPC embedded wallet password\n *  isLoadingEmbeddedWallet, - loading state of the embedded wallet\n *  userHasEmbeddedWallet, - checks if the user has an embedded wallet\n * }\n */\nconst useMPCEmbeddedWallet = () => {\n    const { projectSettings, walletConnectorOptions, user } = useInternalDynamicContext();\n    const { createPassword: internalCreatePassword } = useEmbeddedWalletPassword();\n    const { createCoinbaseMPCWallet } = useCoinbaseMPC();\n    const { isLoadingEmbeddedWallet, setIsLoadingEmbeddedWallet } = useWalletContext();\n    const userHasEmbeddedWallet = () => hasEmbeddedWallet(user, 'coinbase');\n    const createPassword = useCallback((showIntro) => __awaiter(void 0, void 0, void 0, function* () { return internalCreatePassword(showIntro); }), [internalCreatePassword]);\n    const prepareToCreateMPCWallet = useCallback((chains) => __awaiter(void 0, void 0, void 0, function* () {\n        var _a, _b, _c;\n        if (!user) {\n            throw new DynamicError(USER_NOT_LOGGED_IN);\n        }\n        const userWalletsCredentials = getUserWalletsFromVerifiedCredentials(user);\n        const embeddedWalletVerifiedCredential = findEmbeddedWalletFromVerifiedCredentials(user, chains);\n        const isManualMode = ((_a = projectSettings === null || projectSettings === void 0 ? void 0 : projectSettings.sdk.embeddedWallets) === null || _a === void 0 ? void 0 : _a.automaticEmbeddedWalletCreation) === false;\n        // if user has a wallet and it's not embedded,\n        // throw error to follow another flow and set up the right wallet\n        // However, if the user is in manual mode continue.\n        if ((userWalletsCredentials === null || userWalletsCredentials === void 0 ? void 0 : userWalletsCredentials.length) &&\n            !embeddedWalletVerifiedCredential &&\n            !isManualMode) {\n            throw new EmbeddedWalletException('User already has a linked branded wallet, and manual mode creation is not enabled.');\n        }\n        validateMPCProviderEnabled(projectSettings);\n        const connector = (_b = findCoinbaseMPCWallet(walletConnectorOptions)) === null || _b === void 0 ? void 0 : _b.walletConnector;\n        if (!isCoinbaseMpcWalletConnector(connector)) {\n            throw new Error('Coinbase MPC wallet connector not found');\n        }\n        // since we can dynamically change the settings from demov2, we need to set\n        // requires password prop here in case the connector has already been initialized with a different value\n        connector.setRequiredPassword((_c = requiresPasswordForEmbeddedWallet(projectSettings)) !== null && _c !== void 0 ? _c : false);\n    }), [user, projectSettings, walletConnectorOptions]);\n    const canCreateMPCWallet = useCallback((chains) => __awaiter(void 0, void 0, void 0, function* () {\n        try {\n            yield prepareToCreateMPCWallet(chains);\n            return true;\n        }\n        catch (e) {\n            return false;\n        }\n    }), [prepareToCreateMPCWallet]);\n    const createEmbeddedWallet = useCallback((chains) => __awaiter(void 0, void 0, void 0, function* () {\n        if (!user) {\n            throw new DynamicError(USER_NOT_LOGGED_IN);\n        }\n        yield prepareToCreateMPCWallet(chains);\n        setIsLoadingEmbeddedWallet(true);\n        let password;\n        const embeddedWalletVerifiedCredential = findEmbeddedWalletFromVerifiedCredentials(user, chains);\n        if (!embeddedWalletVerifiedCredential &&\n            requiresPasswordForEmbeddedWalletOnSignup(projectSettings)) {\n            password = yield internalCreatePassword(false, true);\n        }\n        const wallet = yield createCoinbaseMPCWallet(chains, password);\n        setIsLoadingEmbeddedWallet(false);\n        return wallet;\n    }), [\n        user,\n        createCoinbaseMPCWallet,\n        internalCreatePassword,\n        prepareToCreateMPCWallet,\n        projectSettings,\n        setIsLoadingEmbeddedWallet,\n    ]);\n    const revealEmbeddedWalletKey = () => __awaiter(void 0, void 0, void 0, function* () {\n        throw new DynamicError('Coinbase MPC wallet does not support headless reveal yet');\n    });\n    return {\n        canCreateMPCWallet,\n        createEmbeddedWallet,\n        createPassword,\n        isLoadingEmbeddedWallet,\n        revealEmbeddedWalletKey,\n        userHasEmbeddedWallet,\n    };\n};\n\nexport { useMPCEmbeddedWallet };\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 1617, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 1623, "column": 0}, "map": {"version":3,"sources":["file:///home/sohail/mystuff/10-Work/projects/erc20saas/frontend/node_modules/%40dynamic-labs/sdk-react-core/src/lib/utils/hooks/useEmbeddedWallet/useEmbeddedWallet.js"],"sourcesContent":["'use client'\nimport { __awaiter } from '../../../../../_virtual/_tslib.js';\nimport { useCallback } from 'react';\nimport { WalletProviderEnum } from '@dynamic-labs/sdk-api-core';\nimport { DynamicError, StorageService } from '@dynamic-labs/utils';\nimport '../../../context/DynamicContext/DynamicContext.js';\nimport '../../../shared/logger.js';\nimport '@dynamic-labs/iconic';\nimport '@dynamic-labs/wallet-connector-core';\nimport 'react/jsx-runtime';\nimport '../../../context/ViewContext/ViewContext.js';\nimport '@dynamic-labs/wallet-book';\nimport { PRIMARY_WALLET_ID } from '../../constants/localStorage.js';\nimport '../../constants/colors.js';\nimport '../../constants/values.js';\nimport '../../../store/state/loadingAndLifecycle.js';\nimport '../../../shared/consts/index.js';\nimport '../../../events/dynamicEvents.js';\nimport '../../../context/CaptchaContext/CaptchaContext.js';\nimport '../../../context/ErrorContext/ErrorContext.js';\nimport { findEmbeddedWalletFromVerifiedCredentials } from '../../functions/findEmbeddedWalletFromVerifiedCredentials/findEmbeddedWalletFromVerifiedCredentials.js';\nimport { USER_NOT_LOGGED_IN } from '../../constants/errors.js';\nimport '@dynamic-labs/multi-wallet';\nimport 'react-international-phone';\nimport { isTurnkeyEnabled } from '../../functions/isTurnkeyEnabled/isTurnkeyEnabled.js';\nimport { isCoinbaseWaasEnabled } from '../../functions/isCoinbaseWaasEnabled/isCoinbaseWaasEnabled.js';\nimport '../../../config/ApiEndpoint.js';\nimport '../../../store/state/user/user.js';\nimport '../../../locale/locale.js';\nimport { hasEmbeddedWallet } from '../../functions/hasEmbeddedWallet/hasEmbeddedWallet.js';\nimport '../../../store/state/projectSettings/projectSettings.js';\nimport '../../../context/AccessDeniedContext/AccessDeniedContext.js';\nimport '../../../context/AccountExistsContext/AccountExistsContext.js';\nimport '../../../context/UserWalletsContext/UserWalletsContext.js';\nimport '../../../context/VerificationContext/VerificationContext.js';\nimport 'react-dom';\nimport { findPrimaryEmbeddedChain } from '../../../views/Passkey/utils/findPrimaryEmbeddedChain/findPrimaryEmbeddedChain.js';\nimport { useWalletContext } from '../../../context/WalletContext/WalletContext.js';\nimport { useIsTurnkeyWallet } from '../useIsTurnkeyWallet/useIsTurnkeyWallet.js';\nimport { useSecureEnclaveEmbeddedWallet } from './useSecureEnclaveEmbeddedWallet/useSecureEnclaveEmbeddedWallet.js';\nimport './useSecureEnclaveEmbeddedWallet/constants.js';\nimport { useMPCEmbeddedWallet } from './useMPCEmbeddedWallet/useMPCEmbeddedWallet.js';\nimport '../../../context/ThemeContext/ThemeContext.js';\nimport '../useUserUpdateRequest/useUpdateUser/userFieldsSchema.js';\nimport '@dynamic-labs/types';\nimport '../../../context/LoadingContext/LoadingContext.js';\nimport 'yup';\nimport '../../../context/MockContext/MockContext.js';\nimport '../../../views/CollectUserDataView/useFields.js';\nimport '../../../context/FieldsStateContext/FieldsStateContext.js';\nimport '../../../context/UserFieldEditorContext/UserFieldEditorContext.js';\nimport '@dynamic-labs/rpc-providers';\nimport '../../../store/state/environmentId.js';\nimport '../../../store/state/walletConnectorOptions.js';\nimport 'react-i18next';\nimport '../../../components/Accordion/components/AccordionItem/AccordionItem.js';\nimport '../../../components/Alert/Alert.js';\nimport '../../../components/ShadowDOM/ShadowDOM.js';\nimport '../../../components/IconButton/IconButton.js';\nimport '../../../components/InlineWidget/InlineWidget.js';\nimport '../../../components/Input/Input.js';\nimport '../../../components/IsBrowser/IsBrowser.js';\nimport '../../../components/MenuList/Dropdown/Dropdown.js';\nimport '../../../components/Transition/ZoomTransition/ZoomTransition.js';\nimport '../../../components/Transition/SlideInUpTransition/SlideInUpTransition.js';\nimport '../../../components/Transition/OpacityTransition/OpacityTransition.js';\nimport '../../../components/OverlayCard/OverlayCardTarget/OverlayCardTarget.js';\nimport '../../../components/PasskeyCreatedSuccessBanner/PasskeyCreatedSuccessBanner.js';\nimport '../../../components/Popper/Popper/Popper.js';\nimport '../../../components/Popper/PopperContext/PopperContext.js';\nimport 'react-focus-lock';\nimport 'qrcode';\nimport 'formik';\nimport '../../../context/FooterAnimationContext/index.js';\nimport '../../../context/WalletGroupContext/WalletGroupContext.js';\nimport '../../../context/IpConfigurationContext/IpConfigurationContext.js';\nimport '../../../context/SocialRedirectContext/SocialRedirectContext.js';\nimport '../../../widgets/DynamicBridgeWidget/views/WalletsView/components/SecondaryWallets/SecondaryWallets.js';\nimport '@hcaptcha/react-hcaptcha';\nimport '../../../widgets/DynamicWidget/context/DynamicWidgetContext.js';\nimport '../../../context/PasskeyContext/PasskeyContext.js';\nimport '../../../store/state/sendBalances.js';\nimport '../../../widgets/DynamicWidget/components/DynamicWidgetHeader/DynamicWidgetHeader.js';\nimport '../../../views/TransactionConfirmationView/TransactionConfirmationView.js';\nimport '../../../widgets/DynamicWidget/views/ManagePasskeysWidgetView/PasskeyCard/PasskeyCard.js';\nimport '../../../../index.js';\nimport '../../../store/state/tokenBalances.js';\nimport '../../../shared/utils/functions/getInitialUrl/getInitialUrl.js';\nimport { useInternalDynamicContext } from '../../../context/DynamicContext/useDynamicContext/useInternalDynamicContext.js';\n\n// Hook exposed to customers and used internally to trigger embedded wallet creation\n/**\n * @returns {\n *  createEmbeddedWallet, - creates Dynamic embedded wallet according to the settings\n *  createOrRestoreSession, - creates or restores session for the embedded wallet\n *  createPasskey, - creates passkey for the embedded wallet\n *  createPassword, - creates MPC embedded wallet password\n *  getPasskeys, - gets passkeys for the embedded wallet\n *  isLoadingEmbeddedWallet, - loading state of the embedded wallet\n *  isSessionActive, - checks if the session is active for the embedded wallet\n *  revealWalletKey, - reveals the private key or recovery phrase for the embedded wallet\n *  sendOneTimeCode, - sends one time code for the embedded wallet\n *  userHasEmbeddedWallet, - checks if the user has an embedded wallet\n * }\n */\nconst useEmbeddedWallet = () => {\n    const { user, projectSettings, setPrimaryWalletId } = useInternalDynamicContext();\n    const { isTurnkeyWallet } = useIsTurnkeyWallet();\n    const { createEmbeddedWallet: createMPCWallet, canCreateMPCWallet, createPassword, revealEmbeddedWalletKey: revealCoinbaseMPCEmbeddedWalletKey, } = useMPCEmbeddedWallet();\n    const { createEmbeddedWallet: createTurnkeyEmbeddedWallet, createEmbeddedWalletAccount, createOrRestoreSession, createPasskey, revealEmbeddedWalletKey: revealTurnkeyEmbeddedWalletKey, getPasskeys, isSessionActive, sendOneTimeCode, getWalletVersion: getTurnkeyWalletVersion, } = useSecureEnclaveEmbeddedWallet();\n    const { isLoadingEmbeddedWallet } = useWalletContext();\n    const userHasEmbeddedWallet = useCallback(() => hasEmbeddedWallet(user), [user]);\n    const getWalletVersion = useCallback(() => {\n        if (!user) {\n            throw new DynamicError(USER_NOT_LOGGED_IN);\n        }\n        if (!userHasEmbeddedWallet()) {\n            throw new DynamicError('Embedded wallet not found');\n        }\n        if (isTurnkeyWallet) {\n            return getTurnkeyWalletVersion();\n        }\n        return undefined;\n    }, [getTurnkeyWalletVersion, isTurnkeyWallet, user, userHasEmbeddedWallet]);\n    /**\n     * Creates Dynamic embedded wallet according to the settings\n     * @param chains - array of chains to create the wallet for\n     * @param options - options for the wallet creation\n     * @returns Promise<Wallet | undefined> - created wallet object\n     */\n    const createEmbeddedWallet = useCallback((chains, options) => __awaiter(void 0, void 0, void 0, function* () {\n        if (yield canCreateMPCWallet(chains)) {\n            const wallet = yield createMPCWallet(chains);\n            return wallet;\n        }\n        const wallet = yield createTurnkeyEmbeddedWallet(chains, options);\n        return wallet;\n    }), [canCreateMPCWallet, createMPCWallet, createTurnkeyEmbeddedWallet]);\n    /**\n     * Reveals the private key or recovery phrase for the embedded wallet\n     * @param options - options for revealing the wallet key\n     * @returns Promise<boolean> - true if the key was revealed successfully\n     */\n    const revealWalletKey = (options) => __awaiter(void 0, void 0, void 0, function* () {\n        if (!user) {\n            throw new DynamicError(USER_NOT_LOGGED_IN);\n        }\n        if (!userHasEmbeddedWallet()) {\n            throw new DynamicError('Embedded wallet not found');\n        }\n        if (isTurnkeyWallet) {\n            return revealTurnkeyEmbeddedWalletKey(options);\n        }\n        return revealCoinbaseMPCEmbeddedWalletKey();\n    });\n    const shouldAutoCreateEmbeddedWallet = useCallback((verifiedUser) => {\n        var _a, _b, _c, _d, _e;\n        const hasEmbeddedWalletProviderEnabled = isTurnkeyEnabled(projectSettings) ||\n            isCoinbaseWaasEnabled(projectSettings);\n        const hasPrimaryWallet = StorageService.getItem(PRIMARY_WALLET_ID);\n        if (!hasEmbeddedWalletProviderEnabled || hasPrimaryWallet) {\n            return false;\n        }\n        // Turnkey specific rules\n        if (verifiedUser) {\n            const primaryEmbeddedChain = findPrimaryEmbeddedChain(projectSettings);\n            const embeddedWalletVerifiedCredentialId = (_a = findEmbeddedWalletFromVerifiedCredentials(verifiedUser, [\n                primaryEmbeddedChain,\n            ])) === null || _a === void 0 ? void 0 : _a.id;\n            const AAWalletCredentialId = (_c = (_b = verifiedUser.verifiedCredentials) === null || _b === void 0 ? void 0 : _b.find((vc) => vc.walletProvider === WalletProviderEnum.SmartContractWallet)) === null || _c === void 0 ? void 0 : _c.id;\n            const targetPrimaryWalletId = AAWalletCredentialId\n                ? AAWalletCredentialId\n                : embeddedWalletVerifiedCredentialId;\n            if (targetPrimaryWalletId) {\n                setPrimaryWalletId(targetPrimaryWalletId);\n                return false;\n            }\n        }\n        if (\n        // if coinbase is enabled it should still call createWallet, despite the turnkey rules\n        !isCoinbaseWaasEnabled(projectSettings) &&\n            isTurnkeyEnabled(projectSettings) &&\n            !((_e = (_d = projectSettings === null || projectSettings === void 0 ? void 0 : projectSettings.sdk) === null || _d === void 0 ? void 0 : _d.embeddedWallets) === null || _e === void 0 ? void 0 : _e.automaticEmbeddedWalletCreation)) {\n            return false;\n        }\n        return true;\n    }, [projectSettings, setPrimaryWalletId]);\n    return {\n        createEmbeddedWallet,\n        createEmbeddedWalletAccount,\n        createOrRestoreSession,\n        createPasskey,\n        createPassword,\n        getPasskeys,\n        getWalletVersion,\n        isLoadingEmbeddedWallet,\n        isSessionActive,\n        revealWalletKey,\n        sendOneTimeCode,\n        shouldAutoCreateEmbeddedWallet,\n        userHasEmbeddedWallet,\n    };\n};\n\nexport { useEmbeddedWallet };\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 1924, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 1930, "column": 0}, "map": {"version":3,"sources":["file:///home/sohail/mystuff/10-Work/projects/erc20saas/frontend/node_modules/%40dynamic-labs/sdk-react-core/src/lib/utils/hooks/useEmbeddedWallet/useSecureEnclaveEmbeddedWallet/utils.js"],"sourcesContent":["'use client'\nimport { __awaiter } from '../../../../../../_virtual/_tslib.js';\n\n// Converts an ArrayBuffer to a hex-encoded string\nconst buf2hex = (buffer) => [...new Uint8Array(buffer)]\n    .map((x) => x.toString(16).padStart(2, '0'))\n    .join('');\n// Takes a base64url-encoded string (e.g. \"nMueRPiAm51YXEjRtka8S_8Ura3HaqbmqDqMJCZmvkM\")\n// and return the corresponding bytes, as an array buffer.\nconst base64urlDecode = (s) => {\n    // Go from base64url encoding to base64 encoding\n    s = (s === null || s === void 0 ? void 0 : s.replace(/-/g, '+').replace(/_/g, '/')) || '';\n    // use `atob` to decode base64\n    return Uint8Array.from(atob(s), (c) => c.charCodeAt(0));\n};\n// Accepts a public key array buffer, and returns a buffer with the compressed version of the public key\nconst compressRawPublicKey = (rawPublicKey) => {\n    const rawPublicKeyBytes = new Uint8Array(rawPublicKey);\n    const len = rawPublicKeyBytes.byteLength;\n    // Drop the y coordinate\n    const compressedBytes = rawPublicKeyBytes.slice(0, (1 + len) >>> 1);\n    // Encode the parity of `y` in first bit\n    compressedBytes[0] = 0x2 | (rawPublicKeyBytes[len - 1] & 0x01);\n    return compressedBytes.buffer;\n};\nconst p256Keygen = () => __awaiter(void 0, void 0, void 0, function* () {\n    // Create a new P-256 keypair\n    const p256Keypair = yield crypto.subtle.generateKey({\n        name: 'ECDSA',\n        namedCurve: 'P-256',\n    }, true, ['sign', 'verify']);\n    // Export the raw public key. By default this will export in uncompressed format\n    const rawPublicKey = yield crypto.subtle.exportKey('raw', p256Keypair.publicKey);\n    // We need to export with JWK format because exporting EC private keys with \"raw\" isn't supported\n    const privateKeyJwk = yield crypto.subtle.exportKey('jwk', p256Keypair.privateKey);\n    // Optional: compress the public key! But you don't have to\n    const compressedPublicKeyBuffer = compressRawPublicKey(rawPublicKey);\n    const privateKeyBuffer = base64urlDecode(privateKeyJwk.d);\n    return {\n        private: buf2hex(privateKeyBuffer),\n        public: buf2hex(compressedPublicKeyBuffer),\n        public_uncompressed: buf2hex(rawPublicKey),\n    };\n});\n\nexport { base64urlDecode, buf2hex, compressRawPublicKey, p256Keygen };\n"],"names":[],"mappings":";;;;;;AACA;AADA;;AAGA,kDAAkD;AAClD,MAAM,UAAU,CAAC,SAAW;WAAI,IAAI,WAAW;KAAQ,CAClD,GAAG,CAAC,CAAC,IAAM,EAAE,QAAQ,CAAC,IAAI,QAAQ,CAAC,GAAG,MACtC,IAAI,CAAC;AACV,wFAAwF;AACxF,0DAA0D;AAC1D,MAAM,kBAAkB,CAAC;IACrB,gDAAgD;IAChD,IAAI,CAAC,MAAM,QAAQ,MAAM,KAAK,IAAI,KAAK,IAAI,EAAE,OAAO,CAAC,MAAM,KAAK,OAAO,CAAC,MAAM,IAAI,KAAK;IACvF,8BAA8B;IAC9B,OAAO,WAAW,IAAI,CAAC,KAAK,IAAI,CAAC,IAAM,EAAE,UAAU,CAAC;AACxD;AACA,wGAAwG;AACxG,MAAM,uBAAuB,CAAC;IAC1B,MAAM,oBAAoB,IAAI,WAAW;IACzC,MAAM,MAAM,kBAAkB,UAAU;IACxC,wBAAwB;IACxB,MAAM,kBAAkB,kBAAkB,KAAK,CAAC,GAAG,AAAC,IAAI,QAAS;IACjE,wCAAwC;IACxC,eAAe,CAAC,EAAE,GAAG,MAAO,iBAAiB,CAAC,MAAM,EAAE,GAAG;IACzD,OAAO,gBAAgB,MAAM;AACjC;AACA,MAAM,aAAa,IAAM,CAAA,GAAA,+KAAA,CAAA,YAAS,AAAD,EAAE,KAAK,GAAG,KAAK,GAAG,KAAK,GAAG;QACvD,6BAA6B;QAC7B,MAAM,cAAc,MAAM,OAAO,MAAM,CAAC,WAAW,CAAC;YAChD,MAAM;YACN,YAAY;QAChB,GAAG,MAAM;YAAC;YAAQ;SAAS;QAC3B,gFAAgF;QAChF,MAAM,eAAe,MAAM,OAAO,MAAM,CAAC,SAAS,CAAC,OAAO,YAAY,SAAS;QAC/E,iGAAiG;QACjG,MAAM,gBAAgB,MAAM,OAAO,MAAM,CAAC,SAAS,CAAC,OAAO,YAAY,UAAU;QACjF,2DAA2D;QAC3D,MAAM,4BAA4B,qBAAqB;QACvD,MAAM,mBAAmB,gBAAgB,cAAc,CAAC;QACxD,OAAO;YACH,SAAS,QAAQ;YACjB,QAAQ,QAAQ;YAChB,qBAAqB,QAAQ;QACjC;IACJ","ignoreList":[0]}},
    {"offset": {"line": 1984, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}